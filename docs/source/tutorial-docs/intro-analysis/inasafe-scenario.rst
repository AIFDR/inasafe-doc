Run a Scenario with InaSAFE===========================Learning Objectives-------------------* Download and Install the InaSAFE plugin* Run InaSAFE on hazard and population* Run InaSAFE on hazard and buildings* Run InaSAFE using aggregation* Use the print buttonIntroduction------------In this chapter we will install the InaSAFE plugin and go through several disaster scenarios.  If you have already installed the InaSAFE plugin, skip to section 2 where we examine the InaSAFE interface and begin setting up our first scenearios.### 1. Install InaSAFE Plugin- Go to the menu at the top of  QGIS and click Plugins > Fetch Python Plugins...  QGIS will connect to various repositories and show a list of available plugins.- Click in the box labeled “Filter” at the top of the Window.  Type *inasafe* into the box.  This will filter the plugins so that only one is displayed, as shown here:.. image:: /static/intro-analysis/4_1.png   :align: center- Select the plugin, and then click the “Install plugin” button.  It may take several minutes for InaSAFE to install... image:: /static/intro-analysis/4_2.png   :align: center- A window will pop up that says “Plugin installed successfully” - Click okay and then close the QGIS Python Plugin Installer window.- If everything went correctly, you should now see the InaSAFE panel on the right hand side of your screen... image:: /static/intro-analysis/4_3.png   :align: center### 2. InaSAFE Panel and Toolbar- If you have closed the InaSAFE panel or it is not showing, you can go to Plugins > InaSAFE > Toggle InaSAFE Dock.  This will show the InaSAFE panel. .. image:: /static/intro-analysis/4_4.png   :align: center- InaSAFE comes with it’s own toolbar.  When you install QGIS it will be positioned at the bottom of the screen.  If it is not displayed, right-click on the toolbar at the top of QGIS and check “Plugins.”.. image:: /static/intro-analysis/4_5.png   :align: center- These tools provide various functions associated with InaSAFE,  We’ll explore them more in detail later, but for now, here’s an overview:.. image:: /static/intro-analysis/4_6.png   :align: center### 3. Jakarta Flood ScenarioNow let’s open up a project that has already been prepared for InaSAFE.  Don’t worry if it’s confusing - you will learn understand more and more throughout this course.  For now, just follow along and get a glimpse at what QGIS and InaSAFE can do.- Click on the folder icon to open a new project... image:: /static/intro-analysis/4_7.png   :align: center- If you still have the project open from the previous chapter, you may be asked if you want to save it.  Click “Discard.”- Navigate the tutorial files and select ***jakarta_floods.qgs***.  Click Open... image:: /static/intro-analysis/4_8.png   :align: centerThis is what a project looks like in QGIS and InaSAFE.  There are three layers.  The first contains OpenStreetMap building data in Jakarta.  The third layer models population in all of Indonesia.  These layers both contain exposure data.  The layer between, ***a flood similar to the 2007 Jakarta event***, is hazard data.  It is a computer representation of the 2007 Jakarta floods.Take a look at these new layers, which cover the area of Jakarta.  You may notice that the bottom two layers look different from the buildings layer when you zoom in closely.  This is because they are different types of files, which will discuss during the next few chapters.  For now don’t worry too much about this.  Simply note that the blue bits represent where the flooding occurred in Jakarta.  The brown polygons are buildings around the city.  The population density might not be readily apparent - we’ll learn more about this in **Chapter 7 - Working with Raster Data**.Now let’s look at the InaSAFE panel on the right.  As we discussed in the introduction we are supplying two inputs to InaSAFE - ***hazard data*** and ***exposure data***.  The second dropdown box says “buildings,” but let’s change this to “people.”- Click on the arrow next to *buildings* and select *people* instead... image:: /static/intro-analysis/4_9.png   :align: center- You should see the third box change.  It will now say “need evacuation” because we are talking about people, not buildings... image:: /static/intro-analysis/4_10.png   :align: centerNow we will see what InaSAFE does - run a scenario.  Keep in mind that we are providing InaSAFE with data, and we are asking it a question:***In a flood similar to the one in Jakarta in 2007, how many people need evacuating?***- Click “Run.”It may take a minute or two to process, but when InaSAFE is finished running you will see that a new layer, has been added to the list on the left.  This new file is also shown on the map, and it represents the population which needs evacuating.  Within the InaSAFE Panel, you will see text and statistics that InaSAFE has determined for us... image:: /static/intro-analysis/4_11.png   :align: center.. image:: /static/intro-analysis/4_12.png   :align: centerIn this scenario there are 1,109,000 people that could be exposed to more than one meter of water.  It is assumed that all of these people will need to evacuate their homes.  InaSAFE provides more information as well, such as the food and health needs that would be required in this scenario. It also shows an Action Checklist, which is designed so that disaster managers can think about what they need to do to prepare for such an event.- Click the “Print...” button at the bottom of the InaSAFE panel... image:: /static/intro-analysis/4_13.png   :align: center- Two PDF files will be generated.  Navigate to where you would like to put them and click “Save.”.. image:: /static/intro-analysis/4_14.png   :align: center- You will now have two PDFs, one showing a map of the impacted area, and another containing all of the statistics and information that InaSAFE has generated... image:: /static/intro-analysis/4_15.png   :align: center  .. image:: /static/intro-analysis/4_16.png   :align: center- This scenario was run with the assumption that any person in more than one meter of water should be evacuated.  But what if the disaster manager decides that anyone in more than 80 centimeters of water should be evacuated?- In this case we can adjust the impact the flood has on evacuation by lowering the level of water that requires evacuation.  We can do this by editing an InaSAFE setting which the impact function uses when a scenario is run... note:: An impact function is an algorithm that InaSAFE processes when we “run” a scenario.  The function calculates the affect of a hazard layer on an exposure layer.- Click the impact function editor button (the pencil icon next to “Need Evacuation”).. image:: /static/intro-analysis/4_17.png   :align: center- Type 0.8 next to *Thresholds*... image:: /static/intro-analysis/4_18.png   :align: center- Click “Run” and review the results.Take a look at the numbers generated by InaSAFE.  Think about how these statistics would be useful when preparing a contingency plan.  Also note the “Action list” created by the software.  This is designed to ask questions that the successful emergency planner should be prepared to answer.### 4.  Buildings AffectedIn the flood scenario, we asked InaSAFE to analyze the data and give us information on how a flood such as the Jakarta 2007 flood would impact the population of Jakarta.  Now let’s adjust the parameters in InaSAFE and see how the flood will impact buildings.- Click on the arrow next to *people* and select *buildings* instead.- The third box will change.  The question that we ask InaSAFE now reads: “How many ***buildings*** will be ***flooded***?”.. image:: /static/intro-analysis/4_19.png   :align: center- Click “Run.”After a minute or two of processing, InaSAFE provides new results.  This time we receive a map and statistics about the impact of the flood on the buildings in Jakarta... image:: /static/intro-analysis/4_20.png   :align: centerIn this scenario, InaSAFE tells us that out of 13,629 buildings in our ***exposure data***, 796 will be flooded.  Not only this, but it provides information about the different types of buildings, how many will be flooded and where they are located.  Once again a set of “action list” questions is prepared that emergency planners should be prepared to answer in case of such an event.  Note that it is different from the previous action list - the questions are specifically related to infrastructure.Because of all the work contributors have done mapping structures with OpenStreetMap, all the important buildings in Jakarta have been mapped (in addition to thousands of households).  Important structures are defined as:		- Clinics		- Fire Stations		- Government		- Hospitals		- Place of Worship		- Police Stations		- Schools		- Sports Centres- Try changing the threshold again and review the results of your InaSAFE analysis.  Do you remember how to print a PDF?### 5.  Aggregate ResultsNow let’s see one more basic InaSAFE function before concluding this chapter.  In this section we will see how we can run InaSAFE and get results only within a certain boundary.  This is called ***aggregation***.- Click the Add Vector Layer button... image:: /static/intro-analysis/4_21.png   :align: center- Navigate to the ***qgis_data/Jakarta*** folder and select ***district_osm_jakarta.shp***.- Click Open, then click Open again.  This will load a new layer, which outlines five districts of Jakarta... image:: /static/intro-analysis/4_22.png   :align: center-  On the InaSAFE panel, click the drop down menu for “Aggregation results by” and select “Districts of Jakarta... image:: /static/intro-analysis/4_23.png   :align: center- Change the threshold back to 1.0.  Make sure that the exposure data is people, not buildings.- Run InaSAFE again.  Notice now that there are detailed reports aggregated by Jakarta district.Summary-------In this chapter we’ve gotten started with InaSAFE and explored the power of running disaster scenarios.  We’ll come back to InaSAFE later, but first we will continue learning more about QGIS, so that you can become a powerful GIS user!